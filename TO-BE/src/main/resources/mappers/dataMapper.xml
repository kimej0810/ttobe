<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tobe.project.mapper.dataMapper">
	<select id="selectAllData" resultType="dataVO">
		SELECT *
		FROM DATA_LIBRARY
		WHERE DELYN='N'
		ORDER BY DIDX DESC
	</select>
	
	<!-- 데이터 업로드 -->
	<insert id="addData" parameterType="dataVO" useGeneratedKeys="true" keyProperty="didx">
	    <selectKey keyProperty="didx" resultType="int" order="BEFORE">
	    	SELECT DIDX_SEQ.NEXTVAL FROM DUAL
	    </selectKey>
	    INSERT INTO DATA_LIBRARY(    
	    	DIDX,
			D_TITLE,
			D_WRITEDATE,
			D_DOWNLOAD,
			DELYN,
			TIDX
		) VALUES(
			#{didx}, 
		    #{d_title}, 
		    sysdate, 
		    0, 
		    'N',
		    1
		)
    </insert>
    <insert id="insertFile" parameterType="hashMap">
    	INSERT INTO FILE_INFOTEST(
    		FIDX,
			TIDX,
			F_TYPE,
			F_ORG_FILE_NAME,
			F_STORED_FILE_NAME,
			F_FILE_SIZE,
			DELYN,
			DIDX
    	)VALUES(
    		F_FILE_SEQ.NEXTVAL,
    		1,
    		#{F_TYPE},
    		#{ORG_FILE_NAME},
    		#{STORED_FILE_NAME},
    		#{FILE_SIZE},
    		'N',
    		#{didx}
    	)
    </insert>
</mapper>